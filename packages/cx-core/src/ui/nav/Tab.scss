@import "variables";
@import "../../util/scss/add-rules";
@import "../Button";
@import "cover";

$cx-tab-state-style-map: cx-merge-state-style-maps($cx-list-item, (
   default: (
      border-radius: $cx-default-border-radius,
      padding: $cx-default-button-padding,
      border-width: $cx-default-button-border-width,
      line-height: $cx-default-box-line-height,
      border-color: transparent,
      border-style: solid,
      text-decoration: none,
      cursor: pointer,
      color: inherit,
   ),
   hover: (
      text-decoration: none
   ),
   disabled: (
      background-color: transparent
   )
));

$cx-tab-mods: (
   classic: (
      default: (
         position: relative,
         border-width: 1px,
         border-bottom-left-radius: 0,
         border-bottom-right-radius: 0,
      ),
      selected: (
         border-color: $cx-default-cover-border-color,
         //border-bottom-color: $cx-default-cover-background-color,
         background-color: $cx-default-cover-background-color,
      )
   ),
   line: (
      default: (
         background-color: transparent !important,
         border-left-color: transparent !important,
         border-right-color: transparent !important,
         border-top-color: transparent !important,
         border-left-width: 0,
         border-right-width: 0,
         border-bottom-width: 2px,
         border-top-width: 0,
         border-bottom-left-radius: 0,
         border-bottom-right-radius: 0,
      ),
      hover: (
         border-color: rgba(128, 128, 128, 0.2),
      ),
      hover-focus: (
         border-color: rgba(123,190,255, 0.3),
      ),
      selected: (
         border-color: rgba(128, 128, 128, 0.4),
      ),
      selected-focus: (
         border-color: rgba(123,190,255, 0.7),
      ),
      active: (),
      disabled: (
         border-color: transparent
      )
   )
) !default;

@mixin cx-tab(
   $name: 'tab',
   $state-style-map: $cx-tab-state-style-map,
   $besm: $cx-besm
) {
   $block: map-get($besm, block);
   $element: map-get($besm, element);
   $state: map-get($besm, state);
   $mod: map-get($besm, mod);

   .#{$block}#{$name} {
      box-sizing: border-box;
      display: inline-block;

      @include cx-add-state-rules($state-style-map, default);

      &:hover {
         @include cx-add-state-rules($state-style-map, hover);
      }

      &:focus {
         @include cx-add-state-rules($state-style-map, hover-focus);
      }

      &.#{$state}active {
         @include cx-add-state-rules($state-style-map, selected);

         &:focus {
            @include cx-add-state-rules($state-style-map, selected-focus);
         }
      }

      &.#{$state}disabled {
         @include cx-add-state-rules($state-style-map, disabled);
      }

      @each $name, $config in $cx-tab-mods {
         &.#{$mod}#{$name} {
            @include cx-add-state-rules($config, default);

            &:hover {
               @include cx-add-state-rules($config, hover);
            }

            &:focus {
               @include cx-add-state-rules($config, hover-focus);
            }

            &.#{$state}active {
               @include cx-add-state-rules($config, selected);

               &:focus {
                  @include cx-add-state-rules($config, selected-focus);
               }
            }

            &.#{$state}disabled {
               @include cx-add-state-rules($config, disabled);
            }
         }
      }

      &.#{$mod}classic.#{$state}active:after {
         content: ' ';
         position: absolute;
         top: 100%;
         left: 0;
         right: 0;
         height: 2px;
         background: cx-get-state-rule(map-get($cx-tab-mods, classic), selected, background-color);
      }
   }
}

@if (cx-include('cx/widgets/Tab')) {
   @include cx-tab();
}
